function canvasZoom(){canvas.setZoom(canvas.getZoom()/1.2)}function loadVenue(){axios({method:"get",url:"/load-venue"}).then(function(t){venueJSON=t,canvas.loadFromJSON(t.data),canvas.renderAll(),fabric.Image.fromURL("http://packager.dev/images/court.png",function(t){t.setOptions({evented:!1,excludeFromExport:!0,hasBorders:!1,hasControls:!1,hasRotatingPoint:!1,height:100,left:440,lockMovementX:!0,lockMovementY:!0,lockRotation:!0,lockScalingX:!0,lockScalingY:!0,top:270,width:155}),canvas.add(t),canvas.renderAll()})})["catch"](function(t){console.log(t)}),canvas.on("object:selected",function(t){selected(t)})}function selected(t){return"zone"!=t.target.type?!1:void axios({method:"GET",url:"/get-data/z"+t.target.number}).then(function(e){canvas.clear(),canvas.setZoom(canvas.getZoom()),canvas.loadFromJSON(e.data);var o="http://packager.dev/images/zones/"+t.target.number+".png";$("#zoneMap").prepend('<a href="/"><img src="'+o+'" class="img-responsive"/></a>'),canvas.renderAll(),canvas.on("mouse:down",function(t){var e=t.target;if("AV"===e.status)e.setStroke("#F96868"),e.setFill("#F96868"),e.setStatus("SL"),view3d_module.load(e.uuid),cart.addToCart(e),canvas.renderAll();else{if("SL"!==e.status)return!1;e.setStroke("#3AA99E"),e.setFill("#3AA99E"),e.setStatus("AV"),cart.removeFromCart(e),canvas.renderAll()}})})["catch"](function(t){console.log(t)})}function getZoneView(t){axios({method:"GET",url:"/get-data/z"+t}).then(function(e){canvas.clear(),canvas.setZoom(canvas.getZoom()),canvas.loadFromJSON(e.data);var o="http://packager.dev/images/zones/"+t+".png",s=$("#zoneMap");s.empty(),s.prepend('<a href="/"><img src="'+o+'" class="img-responsive"/></a>'),canvas.renderAll(),canvas.on("mouse:down",function(t){var e=t.target;if("AV"===e.status)e.setStroke("#F96868"),e.setFill("#F96868"),e.setStatus("SL"),cart.addToCart(e),canvas.renderAll();else{if("SL"!==e.status)return!1;e.setStroke("#3AA99E"),e.setFill("#3AA99E"),e.setStatus("AV"),cart.removeFromCart(e),canvas.renderAll()}})})["catch"](function(t){console.log(t)})}function responsive(){var t=document.getElementById("canvas-holder").offsetWidth;canvas.setWidth(t)}function zoneResponsive(){var t=canvas.getWidth(),e=1040,o=t/e;canvas.forEachObject(function(t){for(var e=0;e<t.points.length;e++)t.points[e].x=Math.round(t.points[e].x*o),t.points[e].y=Math.round(t.points[e].y*o);console.log("Worked!"),t.initialize(t.points,{number:t.number,fill:t.fill})}),canvas.renderAll()}fabric.Zone=new fabric.util.createClass(fabric.Polygon,{type:"zone",initialize:function(t,e){e||(e={}),this.callSuper("initialize",t,e),this.set("number",e.number||"Number not set!"),this.set("angle",e.angle||0),this.set("evented",e.evented||!0),this.set("hasControls",e.hasControls||!1),this.set("hasRotatingPoint",e.hasRotatingPoint||!1),this.set("hoverCursor",e.hoverCursor||"pointer"),this.set("lockMovementX",e.lockMovementX||!0),this.set("lockMovementY",e.lockMovementY||!0),this.set("lockRotation",e.lockRotation||!0),this.set("hasBorders",e.hasBorders||!1),this.set("selectable",e.selectable||!0)},toObject:function(){return fabric.util.object.extend(this.callSuper("toObject"),{number:this.get("number")})},toJSON:function(){return fabric.util.object.extend(this.callSuper("toJSON"),{number:this.get("number")})}}),fabric.Zone.fromObject=function(t,e,o){return fabric.Object._fromObject("Zone",t,e,o,["points","number"])},fabric.Seat=new fabric.util.createClass(fabric.Circle,{type:"seat",initialize:function(t){switch(t||(t={}),this.callSuper("initialize",t),this.set("number",t.number||"Number not set!"),this.set("row",t.row||""),this.set("status",t.status||"IA"),this.set("zoneNumber",t.zoneNumber||"Zone number not set!"),this.set("price",t.price||"Price not set!"),this.set("uuid",t.uuid||""),this.set("categoryColor",t.categoryColor||"#000000"),this.set("categoryID",t.categoryID||0),this.set("fill",t.fill||"#fff"),this.set("hasBorders",t.hasBorders||!1),this.set("hasControls",t.hasControls||!1),this.set("hasRotatingPoint",t.hasRotatingPoint||!1),this.set("hoverCursor",t.hoverCursor||"pointer"),this.set("lockMovementX",t.lockMovementX||!0),this.set("lockMovementY",t.lockMovementY||!0),this.set("lockRotation",t.lockRotation||!0),this.set("radius",t.radius||10),this.status){case"IA":this.set("stroke",t.stroke||"#76838F"),this.set("fill",t.fill||"#76838F"),this.set("selectable",t.selectable||!1);break;case"AV":this.set("stroke",t.stroke||"#46BE8A"),this.set("fill",t.fill||"#46BE8A"),this.set("selectable",t.selectable||!0)}this.set("strokeWidth",t.strokeWidth||3)},toObject:function(){return fabric.util.object.extend(this.callSuper("toObject"),{number:this.get("number"),row:this.get("row"),status:this.get("status"),zoneNumber:this.get("zoneNumber"),price:this.get("price"),categoryID:this.get("categoryID"),categoryColor:this.get("categoryColor"),uuid:this.get("uuid")})},_render:function(t){this.callSuper("_render",t),t.font="15px Helvetica",t.fillStyle="#fff",t.fillText(this.number,-this.radius/2+1,-this.radius/2+10,[7])},setStatus:function(t){this.set("status",t||"AV")}}),fabric.Seat.fromObject=function(t,e,o){return fabric.Object._fromObject("Seat",t,e,o)};var canvas=new fabric.Canvas("c",{selection:!1}),venueJSON,tk3d=new TICKETING3D("eu-tr-00002"),view3d_module=tk3d.loadModule({module:"view3d",container:"three-d"});$(document).ready(function(){responsive(),loadVenue(),canvasZoom()});var cart=new Vue({el:"#cart",data:{items:[],type:this.itemType},computed:{total:function(){for(var t=0,e=0;e<this.items.length;e++)t+=this.items[e].price;return t},itemType:function(){return this.items[0].type},itemCount:function(){return this.items.length},showCart:function(){var t=!1;return this.items.length>0&&(t=!0),t}},methods:{addToCart:function(t){this.items.push(t)},removeFromCart:function(t){t.setStroke("#3AA99E"),t.setFill("#3AA99E"),t.setStatus("AV"),canvas.renderAll(),this.items.splice(this.items.indexOf(t),1)},sendCartData:function(){axios({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},method:"post",url:"/add-to-cart",data:{itemCount:this.itemCount,total:this.total,items:this.items}}).then(function(t){window.location.replace(t.data.redirect)})["catch"](function(t){alert(t)})}}});$(function(){$("#zoomIn").click(function(){canvas.setZoom(1.2*canvas.getZoom())}),$("#zoomOut").click(function(){canvas.setZoom(canvas.getZoom()/1.2)}),$("#goLeft").click(function(){var t=30,e=new fabric.Point(t,0);canvas.relativePan(e)}),$("#goRight").click(function(){var t=30,e=new fabric.Point(-t,0);canvas.relativePan(e)}),$("#goDown").click(function(){var t=30,e=new fabric.Point(0,-t);canvas.relativePan(e)}),$("#goUp").click(function(){var t=30,e=new fabric.Point(0,t);canvas.relativePan(e)})});